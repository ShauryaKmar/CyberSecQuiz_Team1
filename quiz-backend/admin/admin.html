<!DOCTYPE html>
<html>
<head>
  <title>Admin Analytics</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { text-align: center; }
    canvas { margin: 20px auto; display: block; }
    table { border-collapse: collapse; width: 50%; margin: auto; }
    table, th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #f4f4f4; }
  </style>
</head>
<body>

<h1>Cybersecurity Quiz Analytics</h1>

<h2>Topic Performance</h2>
<canvas id="topicChart" width="400" height="200"></canvas>

<h2>Top 5 At-Risk Employees</h2>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Incorrect Answers</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody id="riskTable"></tbody>
</table>

<script>
fetch("https://your-backend-url.com/admin/analytics")
  .then(res => res.json())
  .then(data => {
    // Topic chart
    const ctx = document.getElementById('topicChart').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: data.topicPerformance.map(t => t.topic),
        datasets: [{
          label: '% Incorrect',
          data: data.topicPerformance.map(t => t.incorrectRate),
          backgroundColor: 'rgba(255, 99, 132, 0.5)'
        }]
      }
    });

    // Risk table
    const tableBody = document.getElementById("riskTable");
    data.riskEmployees.forEach(emp => {
      tableBody.innerHTML += `<tr>
        <td>${emp.name}</td>
        <td>${emp.incorrect}</td>
        <td>${emp.score}/${emp.total}</td>
      </tr>`;
    });
  });
</script>

</body>
</html>
